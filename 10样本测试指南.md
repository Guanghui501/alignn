# 10 æ ·æœ¬æµ‹è¯•æŒ‡å—

## ğŸ¯ å¿«é€Ÿæµ‹è¯•ï¼ˆ10 ä¸ªæ ·æœ¬ï¼‰

å¦‚æœæ‚¨åªæƒ³ç”¨å°‘é‡æ ·æœ¬å¿«é€Ÿæµ‹è¯• ALIGNN æ˜¯å¦èƒ½è¿è¡Œï¼Œä½¿ç”¨è¿™ä¸ªæŒ‡å—ã€‚

---

## âœ… ä¸€é”®æµ‹è¯•

```bash
# æ‹‰å–æœ€æ–°é…ç½®
git pull origin claude/alignn-binary-classification-01Gd3smtc3KBu4WsA7u8tEUy

# ä½¿ç”¨ 10 æ ·æœ¬æµ‹è¯•é…ç½®
train_alignn.py \
    --root_dir ./data/cif \
    --config config_test_10samples.json \
    --classification_threshold 0.5 \
    --batch_size 1 \
    --epochs 50 \
    --output_dir ./test_results
```

**é¢„è®¡æ—¶é—´**: 1-2 åˆ†é’Ÿ

---

## ğŸ“‹ æµ‹è¯•é…ç½®è¯´æ˜

### config_test_10samples.json ç‰¹ç‚¹

```json
{
  "epochs": 50,              // å°‘é‡è½®æ•°ï¼Œå¿«é€Ÿæµ‹è¯•
  "batch_size": 1,           // æ‰¹æ¬¡ä¸º1ï¼Œé€‚åˆæå°æ•°æ®é›†
  "learning_rate": 0.0001,   // è¾ƒå°å­¦ä¹ ç‡
  "num_workers": 0,          // å•çº¿ç¨‹ï¼Œé¿å…é—®é¢˜
  "use_lmdb": false,         // ä¸ä½¿ç”¨ç¼“å­˜

  "model": {
    "name": "alignn",        // âœ… æ­£ç¡®çš„åˆ†ç±»æ¨¡å‹
    "alignn_layers": 2,      // æ›´å°çš„æ¨¡å‹
    "gcn_layers": 2,
    "hidden_features": 64,
    "output_features": 2,    // âœ… äºŒåˆ†ç±»éœ€è¦ 2 ä¸ªè¾“å‡º
    "classification": true
  }
}
```

### å…³é”®åŒºåˆ«

| å‚æ•° | å¤§æ•°æ®é›† | 10æ ·æœ¬æµ‹è¯• |
|------|----------|-----------|
| model.name | alignn | alignn âœ… |
| output_features | 2 | 2 âœ… |
| batch_size | 128 | 1 |
| epochs | 300 | 50 |
| hidden_features | 256 | 64 |
| use_lmdb | true | false |
| num_workers | 4 | 0 |

---

## ğŸš€ å®Œæ•´æµ‹è¯•æµç¨‹

### æ­¥éª¤1: å‡†å¤‡æµ‹è¯•æ•°æ®

ç¡®ä¿æœ‰ 10 ä¸ªæ ·æœ¬ï¼š

```bash
# æ£€æŸ¥æ•°æ®
python << 'EOF'
import pandas as pd
import glob

df = pd.read_csv('./data/cif/id_prop.csv')
cif_count = len(glob.glob('./data/cif/*.cif'))

print(f"id_prop.csv: {len(df)} è¡Œ")
print(f"CIF æ–‡ä»¶: {cif_count} ä¸ª")

if len(df) >= 10 and cif_count >= 10:
    print("âœ… æ•°æ®è¶³å¤Ÿæµ‹è¯•")
else:
    print("âš ï¸ æ•°æ®å¯èƒ½ä¸è¶³")
EOF
```

### æ­¥éª¤2: è¿è¡Œæµ‹è¯•

```bash
train_alignn.py \
    --root_dir ./data/cif \
    --config config_test_10samples.json \
    --output_dir ./test_results
```

### æ­¥éª¤3: æŸ¥çœ‹ç»“æœ

```bash
# æŸ¥çœ‹è®­ç»ƒæ—¥å¿—
cat ./test_results/config.json

# æŸ¥çœ‹é¢„æµ‹ç»“æœ
cat ./test_results/prediction_results_test_set.csv

# æŸ¥çœ‹æ¨¡å‹
ls -lh ./test_results/best_model.pt
```

---

## ğŸ“Š é¢„æœŸè¾“å‡º

### æ­£å¸¸è®­ç»ƒè¾“å‡º

```
    _    _     ___ ____ _   _ _   _
   / \  | |   |_ _/ ___| \ | | \ | |
  / _ \ | |    | | |  _|  \| |  \| |
 / ___ \| |___ | | |_| | |\  | |\  |
/_/   \_\_____|___\____|_| \_|_| \_|

Model parameters 258050
CUDA available True
GPU: NVIDIA GeForce RTX 5090

Epoch 1/50
  Train Loss: 0.693 | Time: 2s
  Val Loss: 0.701 | Time: 0s
  âœ“ Saving model

Epoch 2/50
  Train Loss: 0.665 | Time: 1s
  Val Loss: 0.689 | Time: 0s
  âœ“ Saving model

...

Epoch 50/50
  Train Loss: 0.234 | Time: 1s
  Val Loss: 0.456 | Time: 0s

TestLoss 0.456
âœ… è®­ç»ƒå®Œæˆ
```

### ç»“æœæ–‡ä»¶

```
test_results/
â”œâ”€â”€ best_model.pt                      # æœ€ä½³æ¨¡å‹
â”œâ”€â”€ current_model.pt                   # å½“å‰æ¨¡å‹
â”œâ”€â”€ last_model.pt                      # æœ€åæ¨¡å‹
â”œâ”€â”€ config.json                        # é…ç½®
â”œâ”€â”€ history_train.json                 # è®­ç»ƒå†å²
â”œâ”€â”€ history_val.json                   # éªŒè¯å†å²
â”œâ”€â”€ prediction_results_test_set.csv    # é¢„æµ‹ç»“æœ
â””â”€â”€ Test_results.json                  # æµ‹è¯•è¯¦æƒ…
```

---

## âš ï¸ å¸¸è§é—®é¢˜

### Q1: ValueError: Expected 1 or more dimensions

**é”™è¯¯ä¿¡æ¯**:
```
ValueError: Expected 1 or more dimensions (got 0)
```

**åŸå› **: ä½¿ç”¨äº†é”™è¯¯çš„æ¨¡å‹ï¼ˆ`alignn_atomwise` è€Œä¸æ˜¯ `alignn`ï¼‰

**è§£å†³**: ä½¿ç”¨ `config_test_10samples.json`ï¼Œå®ƒå·²ç»é…ç½®æ­£ç¡®çš„æ¨¡å‹

### Q2: steps_per_epoch = 0

**é”™è¯¯ä¿¡æ¯**:
```
ValueError: Expected positive integer steps_per_epoch, but got 0
```

**åŸå› **: `batch_size` å¤§äºæ ·æœ¬æ•°

**è§£å†³**: è®¾ç½® `--batch_size 1`

### Q3: è®­ç»ƒç»“æœå¾ˆå·®

**åŸå› **: 10 ä¸ªæ ·æœ¬å¤ªå°‘ï¼Œæ¨¡å‹æ— æ³•æœ‰æ•ˆå­¦ä¹ 

**è¯´æ˜**: è¿™æ˜¯æ­£å¸¸çš„ï¼10 æ ·æœ¬åªç”¨äºæµ‹è¯•æµç¨‹ï¼Œä¸æ˜¯ä¸ºäº†å¾—åˆ°å¥½çš„æ¨¡å‹ã€‚

å®é™…ä½¿ç”¨éœ€è¦è‡³å°‘ï¼š
- **æœ€å°**: 100-500 æ ·æœ¬
- **æ¨è**: 1000+ æ ·æœ¬
- **ç†æƒ³**: 10000+ æ ·æœ¬

---

## ğŸ’¡ ä¸‹ä¸€æ­¥

### æµ‹è¯•æˆåŠŸå

1. **éªŒè¯æµç¨‹**: âœ… ALIGNN å¯ä»¥è¿è¡Œ
2. **å‡†å¤‡çœŸå®æ•°æ®**: æ”¶é›†æ›´å¤šæ ·æœ¬ï¼ˆå»ºè®® > 1000ï¼‰
3. **æ­£å¼è®­ç»ƒ**: ä½¿ç”¨ `config_large_dataset.json` æˆ– `config_binary_classification.json`

### ä»æµ‹è¯•åˆ°ç”Ÿäº§

```bash
# æµ‹è¯•é˜¶æ®µï¼ˆ10 æ ·æœ¬ï¼‰
train_alignn.py \
    --root_dir ./data/cif \
    --config config_test_10samples.json \
    --output_dir ./test_results

# ç”Ÿäº§é˜¶æ®µï¼ˆå¤§æ•°æ®é›†ï¼‰
train_alignn.py \
    --root_dir ./data/cif \
    --config config_large_dataset.json \
    --batch_size 128 \
    --epochs 100 \
    --output_dir ./production_results
```

---

## ğŸ¯ ä½¿ç”¨åœºæ™¯

### é€‚åˆç”¨ 10 æ ·æœ¬æµ‹è¯•çš„æƒ…å†µ

- âœ… éªŒè¯ ALIGNN å®‰è£…æ­£ç¡®
- âœ… æµ‹è¯• GPU æ˜¯å¦å·¥ä½œ
- âœ… æ£€æŸ¥æ•°æ®æ ¼å¼æ˜¯å¦æ­£ç¡®
- âœ… ç†Ÿæ‚‰è®­ç»ƒæµç¨‹
- âœ… è°ƒè¯•é…ç½®æ–‡ä»¶

### ä¸é€‚åˆçš„æƒ…å†µ

- âŒ è®­ç»ƒå®é™…ä½¿ç”¨çš„æ¨¡å‹
- âŒ è¯„ä¼°æ¨¡å‹æ€§èƒ½
- âŒ å‘è¡¨è®ºæ–‡
- âŒ ç”Ÿäº§ç¯å¢ƒ

---

## ğŸ“ æµ‹è¯•æ£€æŸ¥æ¸…å•

è¿è¡Œæµ‹è¯•å‰ç¡®è®¤ï¼š

```bash
# âœ… æ•°æ®æ ¼å¼æ­£ç¡®
head ./data/cif/id_prop.csv
# åº”è¯¥çœ‹åˆ°:
# id,target
# 0,1
# 1,0
# ...

# âœ… CIF æ–‡ä»¶å­˜åœ¨
ls ./data/cif/*.cif | wc -l
# åº”è¯¥è‡³å°‘æœ‰ 10 ä¸ª

# âœ… GPU å¯ç”¨
python -c "import torch; print('GPU:', torch.cuda.is_available())"
# åº”è¯¥è¾“å‡º: GPU: True

# âœ… é…ç½®æ–‡ä»¶æ­£ç¡®
cat config_test_10samples.json | grep '"name"'
# åº”è¯¥çœ‹åˆ°: "name": "alignn"
```

---

## ğŸš€ ç«‹å³æµ‹è¯•

```bash
# ä¸€é”®æµ‹è¯•
git pull origin claude/alignn-binary-classification-01Gd3smtc3KBu4WsA7u8tEUy && \
train_alignn.py \
    --root_dir ./data/cif \
    --config config_test_10samples.json \
    --output_dir ./test_results
```

**å®Œæˆæ—¶é—´**: 1-2 åˆ†é’Ÿ ğŸ‰

---

## ğŸ“– ç›¸å…³æ–‡æ¡£

- **å¿«é€Ÿå¼€å§‹.md** - å¤§æ•°æ®é›†è®­ç»ƒ
- **GPUè®­ç»ƒæŒ‡å—.md** - GPU ä½¿ç”¨è¯´æ˜
- **é…ç½®å‚æ•°è¯¦è§£.md** - å‚æ•°è¯¦ç»†è¯´æ˜
